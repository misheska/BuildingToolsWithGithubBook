CHAPTER 10: CoffeScript, Hubot and the Activities API


                                  res.reply "No problem, we'll go through this PR in a bug scrub"
                         ...

                         We now have a full implementation of both the accept and  decline  meth-

                      ods inside our Probot.


                      SANITIZING OUR SOURCE CODE

                      It is typically bad form to save passwords (or other access credentials, like

                      oAuth tokens or secrets) inside of source code. Right now we have hard coded
                      them into our application inside of thepr-delegator.coffee    file. We could

                      instead retrieve them from the environment of the running process.

                         ...

                         handler.setSecret process.env.PROBOT_SECRET
                         github = require 'github'
                         ginst = new github version: '3.0.0'
                         handler.setApiToken ginst, process.env.PROBOT_API_TOKEN
                         ...


                         When we launch our probot from the command line, we will need to use a
                      command like this as we are testing locally from our laptop.


                         $ PROBOT_SECRET=XYZABC PROBOT_API_TOKEN=926a701550d4dfae93250dbdc068cce887531 HUBOT_SLACK_TOKEN=xoxb-3295776784-nZxl1H3nyLsVcgdD▯29r1PZCq ./bin/hubot -a slack


                         When we publish into Heroku, we will want to set these as environment vari-
                      ables using the appropriate Heroku commands.


                         $ heroku config:set PROBOT_API_TOKEN=926a701550d4dfae93250dbdc068cce887531
                         Adding config vars and restarting myapp... done, v12
                         PROBOT_API_TOKEN=926a701550d4dfae93250dbdc068cce887531


                         $ heroku config:set PROBOT_SECRET=XYZABC
                         Adding config vars and restarting myapp... done, v12
                         PROBOT_SECRET=XYZABC


                         Don’t forget that when we run our tests, we will need to specify the environ-
                      ment variables on the command line as well.


                         $ PROBOT_SECRET=XYZABC PROBOT_API_TOKEN=926a701550d4dfae93250dbdc068cce887531 node_modules/jasmine-node/bin/jasmine-node --coffe▯e spec/pr-de
                         legator.spec.coffee










       282